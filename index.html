<!doctype html>
const bd = b.dateParsed ? b.dateParsed.valueOf() : 0;
return bd - ad;
}
if (s === 'oldest'){
const ad = a.dateParsed ? a.dateParsed.valueOf() : 0;
const bd = b.dateParsed ? b.dateParsed.valueOf() : 0;
return ad - bd;
}
if (s === 'az') return (a.title||'').localeCompare(b.title||'');
if (s === 'za') return (b.title||'').localeCompare(a.title||'');
return 0;
});


$grid.innerHTML = '';
if (!list.length){ $empty.hidden = false; return; }
$empty.hidden = true;


for (const row of list){
const title = row.title || '(sem t√≠tulo)';
const url = row.url || '#';
const outlet = row.outlet || '';
const dateStr = row.dateParsed ? row.dateParsed.format('DD/MM/YYYY') : (row.date || '');
const summary = row.summary || '';
const tags = row.tags || [];
const firstTag = slugify(tags[0]||'');


const card = document.createElement('article');
card.className = `card ${firstTag ? 'tag-'+firstTag : ''}`;
card.innerHTML = `
<h3 class="title"><a href="${escapeHTML(url)}" target="_blank" rel="noopener noreferrer">${escapeHTML(title)}</a></h3>
<div class="meta">
${dateStr ? `<span class="pill">üóìÔ∏è ${escapeHTML(dateStr)}</span>` : ''}
${outlet ? `<span class="pill">üè∑Ô∏è ${escapeHTML(outlet)}</span>` : ''}
${tags.map(t => `<span class="pill tag-${slugify(t)}">${escapeHTML(t)}</span>`).join('')}
</div>
${summary ? `<p class="desc">${escapeHTML(summary)}</p>` : ''}
`;
$grid.appendChild(card);
}
}


function slugify(str){
return (str||'').toString().toLowerCase()
.normalize('NFD').replace(/[ÃÄ-ÕØ]/g,'')
.replace(/[^a-z0-9]+/g,'-')
.replace(/(^-|-$)/g,'');
}


function isPortuguese(text){
const s = (text||'').toLowerCase();
if(/[√°√¢√£√†√©√™√≠√≥√¥√µ√∫√ß]/.test(s)) return true; // diacritics quick check
const hits = [' de ',' do ',' da ',' dos ',' das ',' para ',' com ',' em ',' por ',' sem ',' sobre ',' entre ',' pelo ',' pela ',' aos ',' √†s ',' ao ',' √† ',' n√£o ',' ser√° ',' foram ',' est√° ',' tamb√©m '];
let score = 0; for (const w of hits){ if (s.includes(w)) score++; }
return score >= 2;
}


function escapeHTML(str){
return (str||'').replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[s]));
}
</script>
</body>
</html>
